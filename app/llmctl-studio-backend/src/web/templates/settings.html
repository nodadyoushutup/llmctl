{% extends "settings_layout.html" %}

{% block settings_content %}
<section class="grid grid-2">
  <div class="card">
    <div class="card-header">
      <h3 class="section-title">Core</h3>
    </div>
    <p class="muted" style="margin-top: 12px;">
      Paths, polling, and provider defaults.
    </p>
    <div class="stack" style="margin-top: 20px;">
      {% for key, value in core_overview.items() %}
        <div class="subcard">
          <p class="eyebrow">{{ key }}</p>
          <p class="muted" style="margin-top: 8px; font-size: 12px;">
            {{ value }}
          </p>
        </div>
      {% endfor %}
    </div>
    <div style="margin-top: 18px;">
      <a class="btn btn-secondary" href="{{ url_for('agents.settings_core') }}">
        <i class="fa-solid fa-arrow-right"></i>
        open
      </a>
    </div>
  </div>

  <div class="card">
    <div class="card-header">
      <h3 class="section-title">Provider</h3>
    </div>
    <p class="muted" style="margin-top: 12px;">
      Provider selection, defaults, and auth.
    </p>
    <div class="stack" style="margin-top: 20px;">
      <div class="subcard">
        <p class="eyebrow">active</p>
        <p class="muted" style="margin-top: 8px; font-size: 12px;">
          {{ provider_overview.label }}
        </p>
      </div>
      <div class="subcard">
        <p class="eyebrow">command</p>
        <p class="muted" style="margin-top: 8px; font-size: 12px;">
          {{ provider_overview.command }}
        </p>
      </div>
      <div class="subcard">
        <p class="eyebrow">default model</p>
        <p class="muted" style="margin-top: 8px; font-size: 12px;">
          {{ default_model_summary.label }}
        </p>
      </div>
    </div>
    <div style="margin-top: 18px;">
      <a class="btn btn-secondary" href="{{ url_for('agents.settings_provider') }}">
        <i class="fa-solid fa-arrow-right"></i>
        open
      </a>
    </div>
  </div>

  <div class="card">
    <div class="card-header">
      <div>
        <h3 class="section-title">Git</h3>
      </div>
      <span class="status {% if gitconfig_overview.exists %}status-success{% else %}status-warning{% endif %}">
        {% if gitconfig_overview.exists %}present{% else %}missing{% endif %}
      </span>
    </div>
    <p class="muted" style="margin-top: 12px;">
      Host-level Git configuration managed in Integrations.
    </p>
    <div class="stack" style="margin-top: 20px;">
      <div class="subcard">
        <p class="eyebrow">path</p>
        <p class="muted" style="margin-top: 8px; font-size: 12px;">
          {{ gitconfig_overview.path }}
        </p>
      </div>
    </div>
    <div style="margin-top: 18px;">
      <a class="btn btn-secondary" href="{{ url_for('agents.settings_integrations_git') }}">
        <i class="fa-solid fa-arrow-right"></i>
        open
      </a>
    </div>
  </div>

  <div class="card">
    <div class="card-header">
      <h3 class="section-title">Integrations</h3>
    </div>
    <p class="muted" style="margin-top: 12px;">
      Connect delivery systems and sync work.
    </p>
    <div class="stack" style="margin-top: 20px;">
      <div class="subcard">
        <div class="row-between">
          <div>
            <p class="eyebrow">GitHub</p>
            <p class="muted" style="margin-top: 8px; font-size: 12px;">
              Repo: {{ integration_overview.github.repo }}
            </p>
          </div>
          <span
            class="status {% if integration_overview.github.connected %}status-success{% else %}status-warning{% endif %}"
          >
            {% if integration_overview.github.connected %}connected{% else %}needs token{% endif %}
          </span>
        </div>
      </div>
      <div class="subcard">
        <div class="row-between">
          <div>
            <p class="eyebrow">Jira</p>
            <p class="muted" style="margin-top: 8px; font-size: 12px;">
              Jira board: {{ integration_overview.jira.board }}
            </p>
            <p class="muted" style="margin-top: 6px; font-size: 12px;">
              Jira project: {{ integration_overview.jira.project_key }}
            </p>
          </div>
          <span
            class="status {% if integration_overview.jira.connected %}status-success{% else %}status-warning{% endif %}"
          >
            {% if integration_overview.jira.connected %}connected{% else %}needs key{% endif %}
          </span>
        </div>
      </div>
      <div class="subcard">
        <div class="row-between">
          <div>
            <p class="eyebrow">Confluence</p>
            <p class="muted" style="margin-top: 6px; font-size: 12px;">
              Confluence space: {{ integration_overview.confluence.space }}
            </p>
          </div>
          <span
            class="status {% if integration_overview.confluence.connected %}status-success{% else %}status-warning{% endif %}"
          >
            {% if integration_overview.confluence.connected %}connected{% else %}needs key{% endif %}
          </span>
        </div>
      </div>
      <div class="subcard">
        <div class="row-between">
          <div>
            <p class="eyebrow">Google Cloud</p>
            <p class="muted" style="margin-top: 8px; font-size: 12px;">
              Project: {{ integration_overview.google_cloud.project_id }}
            </p>
            <p class="muted" style="margin-top: 6px; font-size: 12px;">
              MCP: {% if integration_overview.google_cloud.mcp_enabled %}enabled{% else %}disabled{% endif %}
            </p>
          </div>
          <span
            class="status {% if integration_overview.google_cloud.connected %}status-success{% else %}status-warning{% endif %}"
          >
            {% if integration_overview.google_cloud.connected %}connected{% else %}needs key{% endif %}
          </span>
        </div>
      </div>
      <div class="subcard">
        <div class="row-between">
          <div>
            <p class="eyebrow">Google Workspace</p>
            <p class="muted" style="margin-top: 8px; font-size: 12px;">
              Delegated user: {{ integration_overview.google_workspace.delegated_user }}
            </p>
            <p class="muted" style="margin-top: 6px; font-size: 12px;">
              MCP: {% if integration_overview.google_workspace.mcp_enabled %}enabled{% else %}disabled{% endif %}
              {% if integration_overview.google_workspace.mcp_guarded %}(guarded){% endif %}
            </p>
          </div>
          <span
            class="status {% if integration_overview.google_workspace.connected %}status-success{% else %}status-warning{% endif %}"
          >
            {% if integration_overview.google_workspace.connected %}connected{% else %}needs key{% endif %}
          </span>
        </div>
      </div>
      <div class="subcard">
        <div class="row-between">
          <div>
            <p class="eyebrow">ChromaDB</p>
            <p class="muted" style="margin-top: 8px; font-size: 12px;">
              Host: {{ integration_overview.chroma.host }}
            </p>
            <p class="muted" style="margin-top: 6px; font-size: 12px;">
              Port: {{ integration_overview.chroma.port }}
            </p>
            <p class="muted" style="margin-top: 6px; font-size: 12px;">
              TLS: {{ integration_overview.chroma.ssl }}
            </p>
          </div>
          <span
            class="status {% if integration_overview.chroma.connected %}status-success{% else %}status-warning{% endif %}"
          >
            {% if integration_overview.chroma.connected %}connected{% else %}needs host + port{% endif %}
          </span>
        </div>
      </div>
    </div>
    <div style="margin-top: 18px;">
      <a class="btn btn-secondary" href="{{ url_for('agents.settings_integrations') }}">
        <i class="fa-solid fa-arrow-right"></i>
        open
      </a>
    </div>
  </div>

  <div class="card">
    <div class="card-header">
      <h3 class="section-title">Celery</h3>
    </div>
    <p class="muted" style="margin-top: 12px;">
      Broker, backend, and transport settings.
    </p>
    <div class="stack" style="margin-top: 20px;">
      {% for key, value in celery_overview.items() %}
        <div class="subcard">
          <p class="eyebrow">{{ key }}</p>
          <p class="muted" style="margin-top: 8px; font-size: 12px;">
            {{ value }}
          </p>
        </div>
      {% endfor %}
    </div>
    <div style="margin-top: 18px;">
      <a class="btn btn-secondary" href="{{ url_for('agents.settings_celery') }}">
        <i class="fa-solid fa-arrow-right"></i>
        open
      </a>
    </div>
  </div>

  <div class="card">
    <div class="card-header">
      <h3 class="section-title">Runtime</h3>
    </div>
    <p class="muted" style="margin-top: 12px;">
      Agent loop cadence and stop behavior.
    </p>
    <div class="stack" style="margin-top: 20px;">
      {% for key, value in runtime_overview.items() %}
        <div class="subcard">
          <p class="eyebrow">{{ key }}</p>
          <p class="muted" style="margin-top: 8px; font-size: 12px;">
            {{ value }}
          </p>
        </div>
      {% endfor %}
    </div>
    <div style="margin-top: 18px;">
      <a class="btn btn-secondary" href="{{ url_for('agents.settings_runtime') }}">
        <i class="fa-solid fa-arrow-right"></i>
        open
      </a>
    </div>
  </div>
</section>
{% endblock %}
