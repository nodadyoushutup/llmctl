{% extends "base.html" %}

{% block topbar_actions %}
  <a class="btn btn-secondary" href="{{ url_for('agents.view_mcp', mcp_id=mcp_server.id) }}">
    <i class="fa-solid fa-arrow-left"></i>
    back
  </a>
  <button type="submit" class="btn btn-primary" form="mcp-edit-form">
    <i class="fa-solid fa-floppy-disk"></i>
    save
  </button>
  <form
    method="post"
    action="{{ url_for('agents.delete_mcp', mcp_id=mcp_server.id) }}"
    onsubmit="return confirm('Delete this MCP server?');"
  >
    <input
      type="hidden"
      name="next"
      value="{{ url_for('agents.list_mcps') }}"
    />
    <button type="submit" class="btn btn-danger">
      <i class="fa-solid fa-trash"></i>
      delete
    </button>
  </form>
{% endblock %}

{% block content %}
<section class="card">
  <div class="card-header">
    <div>
      <p class="eyebrow">mcp server {{ mcp_server.id }}</p>
      <h2 class="section-title">Edit MCP Server</h2>
    </div>
  </div>
  <p class="muted" style="margin-top: 12px;">
    Update the server details and config.
  </p>
  <form
    method="post"
    action="{{ url_for('agents.update_mcp', mcp_id=mcp_server.id) }}"
    class="form-grid"
    id="mcp-edit-form"
    style="margin-top: 20px;"
  >
    <label class="label">
      name
      <input type="text" name="name" value="{{ mcp_server.name }}" class="input" />
    </label>
    <label class="label">
      server key
      <input
        type="text"
        name="server_key"
        value="{{ mcp_server.server_key }}"
        class="input"
      />
      <span class="muted" style="font-size: 12px; margin-top: 6px;">
        If you change this, update the config header to match.
      </span>
    </label>
    <label class="label">
      description (optional)
      <textarea name="description" class="textarea" rows="3">{{ mcp_server.description or "" }}</textarea>
    </label>
    <label class="label">
      config toml
      <textarea name="config_json" class="textarea">{{ mcp_server.config_json }}</textarea>
      <span class="muted" style="font-size: 12px; margin-top: 6px;">
        Use a single mcp_servers entry. Arrays must contain scalar values.
      </span>
    </label>
  </form>
</section>
{% endblock %}
