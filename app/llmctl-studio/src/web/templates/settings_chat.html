{% extends "settings_layout.html" %}

{% block settings_content %}
<section class="card">
  <div class="card-header">
    <h2 class="section-title">Chat Runtime Settings</h2>
  </div>
  <p class="muted" style="margin-top: 12px;">
    Global context budget and compaction settings for Launch Chat sessions.
  </p>
  <form method="post" action="{{ url_for('agents.update_chat_runtime_settings_route') }}" style="margin-top: 16px;">
    <div class="grid" style="grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 10px;">
      <label>
        History budget %
        <input type="number" name="history_budget_percent" value="{{ chat_runtime_settings.history_budget_percent }}" min="10" max="90" />
      </label>
      <label>
        RAG budget %
        <input type="number" name="rag_budget_percent" value="{{ chat_runtime_settings.rag_budget_percent }}" min="0" max="80" />
      </label>
      <label>
        MCP budget %
        <input type="number" name="mcp_budget_percent" value="{{ chat_runtime_settings.mcp_budget_percent }}" min="0" max="90" />
      </label>
      <label>
        Compaction trigger %
        <input type="number" name="compaction_trigger_percent" value="{{ chat_runtime_settings.compaction_trigger_percent }}" min="70" max="100" />
      </label>
      <label>
        Compaction target %
        <input type="number" name="compaction_target_percent" value="{{ chat_runtime_settings.compaction_target_percent }}" min="40" max="99" />
      </label>
      <label>
        Preserve recent turns
        <input type="number" name="preserve_recent_turns" value="{{ chat_runtime_settings.preserve_recent_turns }}" min="1" max="20" />
      </label>
      <label>
        RAG top-k
        <input type="number" name="rag_top_k" value="{{ chat_runtime_settings.rag_top_k }}" min="1" max="50" />
      </label>
      <label>
        Default context tokens
        <input type="number" name="default_context_window_tokens" value="{{ chat_runtime_settings.default_context_window_tokens }}" min="1024" max="1000000" />
      </label>
      <label>
        Max summary chars
        <input type="number" name="max_compaction_summary_chars" value="{{ chat_runtime_settings.max_compaction_summary_chars }}" min="200" max="10000" />
      </label>
    </div>
    <button type="submit" class="btn btn-secondary" style="margin-top: 12px;">
      <i class="fa-solid fa-floppy-disk"></i>
      save chat runtime settings
    </button>
  </form>
</section>
{% endblock %}
